<div class="abilities-page">
  <!-- Psyche Section -->
  <div class="psyche-section" style="text-align: center; margin-bottom: 20px;">
    <div style="display: flex; justify-content: center; align-items: center;">
      {{#if system.psyche}}
        <button class="psyche-roll-button" style="margin-right: 20px;">
          Roll Psyche ({{system.psyche}}d6)
        </button>
      {{else}}
        <button class="psyche-roll-button" style="margin-right: 20px;" disabled>
          Roll Psyche (N/A)
        </button>
      {{/if}}
      <div class="psyche-burst-checkboxes" style="display: flex; align-items: center;">
        <label style="margin-right: 10px;">Psyche Burst Charges:</label>
        {{#if system.psycheBurst}}
          {{#range 0 system.psycheBurst.max}}
            <input type="checkbox" id="checkbox-{{index}}" class="psyche-burst-checkbox" {{#if (lt index ../system.psycheBurst.value)}}checked{{/if}} />
            <label for="checkbox-{{index}}"></label>
          {{/range}}
        {{else}}
          <p>No Psyche Burst Data</p>
        {{/if}}
      </div>
    </div>
    <div class="psyche-info" style="margin-top: 20px; text-align: left;">
      <p>Using any blasphemy power requires a psyche burst. Some can spend multiple for extra benefit.</p>
      <ul>
        <li>You can always spend a psyche burst to add +1 advantage die to any roll (yours or an allyâ€™s) by using your blasphemies in a creative way.</li>
        <li>You always start a mission with three psyche bursts.</li>
        <li>You can recover them by resting during a hunt (see pg. 38) or through the uses of abilities.</li>
      </ul>
    </div>
  </div>
  <!-- Items Section -->
  <div class="items-section" style="display: flex; justify-content: space-between;">
    <!-- Agendas -->
    <div class="agendas" style="width: 48%;">
      <h2>Agendas</h2>
      {{#each items as |item|}}
        {{#if (eq item.type "agenda")}}
          {{#unless agendaFound}}
            {{#set this "agendaFound" true}}
            <ol class='items-list'>
          {{/set}}
          {{/unless}}
          <li class='item flexrow' data-item-id='{{item._id}}'>
            <div class='item-name flexrow'>
              <div class='item-image'>
                <a class='rollable' data-roll-type='item'><img
                    src='{{item.img}}'
                    title='{{item.name}}'
                    width='24'
                    height='24'
                  /></a>
              </div>
              <h4>{{item.name}}</h4>
            </div>
            <div class='item-controls'>
              <a
                class='item-control item-edit'
                title='{{localize "DOCUMENT.Update" type='Item'}}'
              >
                <i class='fas fa-edit'></i>
              </a>
              <a
                class='item-control item-delete'
                title='{{localize "DOCUMENT.Delete" type='Item'}}'
              >
                <i class='fas fa-trash'></i>
              </a>
              <a
                class='item-control item-description'
                title='{{localize "DOCUMENT.Description" type='Item'}}'
              >
                <i class='fas fa-info-circle'></i>
              </a>
            </div>
          </li>
        {{/if}}
      {{/each}}
      {{#unless agendaFound}}
        <p class="psychedelic-text">Drag agenda onto your sheet.</p>
      {{/unless}}
      {{#if agendaFound}}
        </ol>
      {{/if}}
    </div>

    <!-- Blasphemy Powers -->
    <div class="blasphemy-powers" style="width: 48%;">
      <h2>Blasphemy Powers</h2>
      {{#each items as |item|}}
        {{#if (eq item.type "blasphemy")}}
          {{#unless blasphemyFound}}
            {{#set this "blasphemyFound" true}}
            <ol class='items-list'>
          {{/set}}
          {{/unless}}
          <li class='item flexrow' data-item-id='{{item._id}}'>
            <div class='item-name flexrow'>
              <div class='item-image'>
                <a class='rollable' data-roll-type='item'><img
                    src='{{item.img}}'
                    title='{{item.name}}'
                    width='24'
                    height='24'
                  /></a>
              </div>
              <h4>{{item.name}}</h4>
            </div>
            <div class='item-controls'>
              <a
                class='item-control item-edit'
                title='{{localize "DOCUMENT.Update" type='Item'}}'
              >
                <i class='fas fa-edit'></i>
              </a>
              <a
                class='item-control item-delete'
                title='{{localize "DOCUMENT.Delete" type='Item'}}'
              >
                <i class='fas fa-trash'></i>
              </a>
              <a
                class='item-control item-description'
                title='{{localize "DOCUMENT.Description" type='Item'}}'
              >
                <i class='fas fa-info-circle'></i>
              </a>
            </div>
          </li>
        {{/if}}
      {{/each}}
      {{#unless blasphemyFound}}
        <p class="psychedelic-text">Drag blasphemies onto your sheet</p>
      {{/unless}}
      {{#if blasphemyFound}}
        </ol>
      {{/if}}
    </div>
  </div>
</div>

<style>
  .abilities-page {
    padding: 20px;
  }

  .psyche-roll-button {
    background: linear-gradient(45deg, #ff00cc, #3333ff);
    color: #fff;
    border: 2px solid #ff00cc;
    padding: 10px 20px;
    cursor: pointer;
    font-family: "Lacquer", system-ui;
    font-weight: 400;
    font-style: normal;
    font-size: 16px;
    text-shadow: 1px 1px 2px #000;
    transition: background 0.3s;
  }

  .psyche-roll-button:hover {
    background: linear-gradient(45deg, #3333ff, #ff00cc);
  }

  .psyche-burst-checkboxes input[type="checkbox"] {
    display: none;
  }

  .psyche-burst-checkboxes input[type="checkbox"] + label {
    display: inline-block;
    padding: 0;
    background: url('systems/cain/assets/brain.png') no-repeat;
    height: 50px;
    width: 50px;
    background-size: cover;
    position: relative;
  }

  .psyche-burst-checkboxes input[type="checkbox"] + label::before {
    content: '';
    display: block;
    width: 24px;
    height: 24px;
    border: 3px solid purple; /* Adjust the thickness here */
    border-radius: 50%;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }

  .psyche-burst-checkboxes input[type="checkbox"]:checked + label::before {
    background-color: purple;
  }

  .items-section {
    margin-top: 20px;
  }

  .items-list {
    background-color: #1a1a1a;
    color: #e0e0e0;
    font-family: 'Courier New', Courier, monospace;
    padding: 20px;
    border: 1px solid #444;
  }

  .item-name h4 {
    color: #ff0000;
  }

  .item-controls a {
    color: #e0e0e0;
    margin-left: 5px;
  }

  .item-controls a:hover {
    color: #ff0000;
  }

  .create-agenda-button, .create-blasphemy-button {
    background-color: #1a1a1a;
    color: #e0e0e0;
    border: 1px solid #444;
    padding: 10px 20px;
    cursor: pointer;
    margin-top: 10px;
  }

  .create-agenda-button:hover, .create-blasphemy-button:hover {
    background-color: #444;
  }

  .psychedelic-text {
    color: #9933ff;
    font-family: "Lacquer", system-ui;
    font-weight: 400;
    font-style: normal;
    font-size: 18px;
    text-shadow: 2px 2px 4px #000;
    animation: psychedelic-animation 1s infinite alternate;
    font-weight: calc(100 + (900 - 100) * random());
    font-size: calc(16px + (32px - 16px) * random());
  }

  @keyframes psychedelic-animation {
    from {
      color: #ff00cc;
    }
    to {
      color: #3333ff;
    }
  }
</style>